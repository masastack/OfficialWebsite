@inject MasaBlazor MasaBlazor
@rendermode InteractiveServer
@implements IDisposable

<MMenu OpenOnClick="IsMobile"
       OpenOnHover="!IsMobile"
       CloseOnClick
       NudgeBottom="8"
       NudgeLeft="@NudgeLeft"
       OffsetY
       Permanent
       @key="@IsMobile">
    <ActivatorContent>
        <MButton Width="@IconSize"
                 Height="@IconSize"
                 Outlined Icon
                 Color="white"
                 Class="mr-9"
                 @attributes="@context.Attrs">
            <MIcon Large="!IsMobile">
                mdi-qqchat
            </MIcon>
        </MButton>
    </ActivatorContent>
    <ChildContent>
        <img src="https://cdn.masastack.com/images/contact-qq.png" 
             alt="qq"
             width="@Size" />
    </ChildContent>
</MMenu>

@code {

    private bool IsMobile => MasaBlazor.Breakpoint.Mobile;

    private int Size => IsMobile ? 120 : 200;

    private int IconSize =>  IsMobile ? 40 : 60;

    private int NudgeLeft => Size / 2 - IconSize / 2;

    protected override void OnInitialized()
    {
        base.OnInitialized();

        MasaBlazor.MobileChanged += MasaBlazorOnMobileChanged;
    }

    private void MasaBlazorOnMobileChanged(object? sender, MobileChangedEventArgs e)
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        MasaBlazor.MobileChanged -= MasaBlazorOnMobileChanged;
    }

}
