<MCard Class="activity-card" Flat Color="transparent">
    <div class="activity-card__header">
        <span class="activity-card__date">@Data.Date.ToString("MM.dd")</span>
        <span class="activity-card__time">@Data.StartTime.ToString("HH:mm") - @Data.EndTime.ToString("HH:mm")</span>
    </div>

    <div class="activity-card__desc" @onclick="GoTo">
        <MImage Src="@Data.Cover" Height="@(IsMobile ? null : 290)" Width="@(IsMobile ? "100%" : null)" Contain Style="border-radius: 16px;"></MImage>
    </div>

    <div class="activity-card__footer">
        <MAvatar Size="36" Color="#D9D1FF" Class="activity-card__group">
            <MIcon Color="#4318FF" Small>mdi-account-group</MIcon>
        </MAvatar>
        <PBlockText PrimaryClass="activity-card__title" SecondaryClass="activity-card__subtitle">
            <PrimaryContent>
                <div @onclick="GoTo">@Data.Title</div>
                @if (Data.Type != ActivityType.All)
                {
                    var (label, color) = FormatType(Data.Type);
                    <MChip Dark Label Small Color="@color" Class="ml-2">@label</MChip>
                }
            </PrimaryContent>
            <SecondaryContent>
                @Data.Subtitle
            </SecondaryContent>
        </PBlockText>
    </div>
</MCard>

@code {

    [CascadingParameter(Name = "IsMobile")]
    public bool IsMobile { get; set; }

    [Inject]
    public NavigationManager? NavigationManager { get; set; } = null!;

    [Parameter, EditorRequired]
    public Activity Data { get; set; } = null!;

    private (string text, string color) FormatType(ActivityType type)
    {
        return type switch
        {
            ActivityType.CommunityMeeting => ("社区例会", "green"),
            ActivityType.ProductLaunching => ("产品发布会", "blue"),
            ActivityType.Training => ("培训", "pink"),
            ActivityType.Meetup => ("线下聚会", "purple"),
            _ => throw new ArgumentOutOfRangeException(nameof(type), type, null)
            };
    }

    private void GoTo()
    {
        if (Data.Id == null)
        {
            return;
        }

        NavigationManager.NavigateTo($"/activityDetail/{Data.Id}", false);
    }

}
